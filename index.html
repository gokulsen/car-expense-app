<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Car Loan and Maintenance Calculator</title>
		<style>
			body {
				font-family: Arial, sans-serif;
				display: flex;
				background-color: #f4f4f9;
				margin: 0;
				padding: 0;
				justify-content: center;
				align-items: center;
				min-height: 100vh;
				flex-direction: column;
				box-sizing: border-box;
				background-color: #e9ecef; /* Light background color for body */
			}

			/* Header with logo and branding text */
			header {
				width: 100%;
				text-align: center;
				margin-bottom: 30px; /* Space between logo and content */
			}

			.logo-container {
				display: flex;
				align-items: center; /* Aligns logo and text vertically */
				justify-content: center; /* Centers logo and text horizontally */
			}

			.logo {
				width: 150px;  /* Adjust width as needed */
				height: auto;
				margin-right: 10px; /* Space between logo and text */
			}

			.branding-text {
				font-size: 40px;
				font-weight: 600;
				color: #2985A5; /* Branding text color */
				letter-spacing: 1px;
			}
			.container {
				display: flex;
				width: 90%;
				max-width: 1200px;
				padding: 20px;
				background-color: #fff; /* White background for the container */
				border-radius: 12px;
			}
			.left-column {
				width: 30%;
				padding: 20px;
				background-color: #ffffff; /* Light white background for left column */
				box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
				border-radius: 8px;
				border: 1px solid #ddd; /* Border for left column */
			}
			.right-column {
				width: 70%;
				padding: 20px;
				background-color: #f8f9fa; /* Slightly darker background for right column */
				margin-left: 20px;
				box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
				border-radius: 8px;
				border: 1px solid #ddd; /* Border for right column */
			}
			h2 {
				text-align: center;
				font-size: 24px;
				font-weight: 600;
				color: #2985A5; /* Set heading color to theme color */
			}
			label {
				font-weight: bold;
				color: #2985A5; /* Set label color to theme color */
			}
			input {
				width: 100%;
				padding: 8px;
				border: 1px solid #2985A5; /* Set input border color to theme color */
				border-radius: 4px;
				margin: 8px 0;
				background-color: #ffffff;
				font-size: 16px;
			}
			input:focus {
				border-color: #80bdff; /* Focused input field color */
				outline: none;
			}
			button {
				background-color: #2985A5; /* Set button background color to theme color */
				color: white;
				border: none;
				font-size: 16px;
				cursor: pointer;
				border-radius: 4px;
				transition: background-color 0.3s, transform 0.2s;
				padding: 10px;
			}
			button:hover {
				background-color: #1f6f8b; /* Darker theme color for button hover */
			}
			button:active {
				background-color: #1a5c77; /* Even darker theme color when button is clicked */
			}
			.report {
				margin-top: 20px;
				padding: 15px;
				background-color: #d4edda; /* Light green background for report */
				border: 1px solid #c3e6cb; /* Border color for report */
				display: none;
				box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
				border-radius: 8px;
			}
			.report-container {
				display: flex;
				flex-direction: row;
				justify-content: space-between;
			}
			.report-column {
				width: 48%;
			}
			.report hr {
				border: 0;
				height: 1px;
				background: #ccc;
				margin: 10px 0;
			}
			.notes {
				margin-top: 20px;
				padding: 15px;
				background-color: #cccc; /* Light red background for notes */
				border: 1px solid #f5c6cb; /* Border color for notes */
				box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
				border-radius: 8px;
			}
			.notes h3 {
				margin-top: 0;
				color: #721c24; /* Dark red color for note headings */
			}
			canvas {
				width: 100% !important;
				max-width: 400px;
				height: 800px !important;  /* Set a fixed height, adjust as needed */
				display: block;
				max-height: 900px;  /* Optional: Set a max height to prevent excessive growth */
				object-fit: contain;  /* Keeps the aspect ratio intact */
			}

			/* Mobile responsiveness */
			@media screen and (max-width: 768px) {
				.container {
					flex-direction: column;
				}
				.left-column, .right-column {
					width: 100%;
					margin-left: 0;
				}
			}
		</style>
</head>
<body>
    <header>
        <!--<img src="C:\Users\09184G744\OneDrive - IBM\Desktop\logo.png" alt="Logo" class="logo">-->
		<span class="branding-text">Car Expense Calculator</span>
    </header>
    <div class="container">
        <!-- Left Column (Input Form) -->
        <div class="left-column">
            <h2>Car and Loan Details</h2>
            <label for="carModel">Car Model</label>
            <input type="text" id="carModel" value="Kia Seltos HTK+ Petrol Manual">

            <h3>Loan Details</h3>
            <label for="downPayment">Down Payment</label>
            <input type="number" id="downPayment" value="350000.00">

            <label for="principal">Principal (Loan Amount)</label>
            <input type="number" id="principal" value="1100000.00">

            <label for="interestRate">Rate of Interest (%)</label>
            <input type="number" id="interestRate" value="8.85">

            <label for="termMonths">Term (Months)</label>
            <input type="number" id="termMonths" value="84">

            <label for="monthsPaid">Months Paid</label>
            <input type="number" id="monthsPaid" value="57">
			
			<label for="emiPaidInAdvance">EMI Paid in Advance </label>
            <input type="number" id="emiPaidInAdvance" value="47536.8">

            <h3>Maintenance Details</h3>
            <label for="distance">Distance Ran Per Year (km)</label>
            <input type="number" id="distance" value="10000">

            <label for="mileage">Mileage (km/l)</label>
            <input type="number" id="mileage" value="14">

            <label for="fuelCost">Fuel Cost per Liter</label>
            <input type="number" id="fuelCost" value="105.00">

            <label for="serviceMaintenance">Service Maintenance (per Year)</label>
            <input type="number" id="serviceMaintenance" value="12000.00">

            <label for="otherMaintenance">Other Maintenance & Repair</label>
            <input type="number" id="otherMaintenance" value="67000.00">

            <label for="ownershipPeriod">Ownership Period (Months) (Tentative)</label>
            <input type="number" id="ownershipPeriod" value="120">

			<h3>Car Resale Value</h3
			<label for="resaleValue">Resale Value</label>
      		<input type="number" id="resaleValue" value="1000000">

         	<button onclick="generateReport()">Generate Report</button>
			<button onclick="loadLastSavedData()">Use Last Saved Data</button>
        </div>

        <!-- Right Column (Report Display) -->
        <div class="right-column">
            <h2>Expense Summary Report</h2>
            <div class="report-container">
                <!-- Expense Report Section -->
                <div class="report-column" id="expenseReport" class="report"></div>

                <!-- Two Columns for Charts -->
                <div class="report-column">
                    <canvas id="expenseChartToDate"></canvas>
                </div>
                <div class="report-column">
                    <canvas id="expenseChartOwnership"></canvas>
                </div>
            </div>

            <!-- Notes Section -->
            <div class="notes">
                <h2>Notes</h2>
                <textarea id="noteInput" placeholder="Type your note here..." style="width: calc(100% - 16px); height: 60px; font-size: 16px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; resize: vertical;"></textarea>
                <button onclick="addNote()">Save Note</button>
                <div class="notes-list" id="notesList"></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <script>
        function generateReport() {
            // Get inputs from user
            const carModel = document.getElementById("carModel").value;
            const downPayment = parseFloat(document.getElementById("downPayment").value);
            const principal = parseFloat(document.getElementById("principal").value);
            const interestRate = parseFloat(document.getElementById("interestRate").value);
            const termMonths = parseInt(document.getElementById("termMonths").value);
			const emiPaidInAdvance = parseInt(document.getElementById("emiPaidInAdvance").value);
            const ownershipPeriod = parseInt(document.getElementById("ownershipPeriod").value);
            const distance = parseInt(document.getElementById("distance").value);
            const mileage = parseFloat(document.getElementById("mileage").value);
            const fuelCost = parseFloat(document.getElementById("fuelCost").value);
            const serviceMaintenance = parseFloat(document.getElementById("serviceMaintenance").value);
            const otherMaintenance = parseFloat(document.getElementById("otherMaintenance").value);
            const monthsPaid = parseInt(document.getElementById("monthsPaid").value);
			const resaleValue = parseInt(document.getElementById("resaleValue").value);
			
	// Save input values to localStorage
            localStorage.setItem('carModel', carModel);
            localStorage.setItem('downPayment', downPayment);
            localStorage.setItem('principal', principal);
            localStorage.setItem('interestRate', interestRate);
            localStorage.setItem('termMonths', termMonths);
			localStorage.setItem('emiPaidInAdvance', emiPaidInAdvance);
            localStorage.setItem('ownershipPeriod', ownershipPeriod);
            localStorage.setItem('distance', distance);
            localStorage.setItem('mileage', mileage);
            localStorage.setItem('fuelCost', fuelCost);
            localStorage.setItem('serviceMaintenance', serviceMaintenance);
            localStorage.setItem('otherMaintenance', otherMaintenance);
            localStorage.setItem('monthsPaid', monthsPaid);
			localStorage.setItem('resaleValue', resaleValue);

            // EMI Calculation
            const monthlyInterestRate = (interestRate / 100) / 12;
            const emi = (principal * monthlyInterestRate * Math.pow(1 + monthlyInterestRate, termMonths)) / (Math.pow(1 + monthlyInterestRate, termMonths) - 1);
            const totalLoanAmount = emi * termMonths;

            // EMI Paid to date
            const emiPaidToDate = emi * monthsPaid + emiPaidInAdvance;
			const emiToBePaid = totalLoanAmount - emiPaidToDate;

            // Maintenance Cost Calculation
            const ownershipPeriodInYears = ownershipPeriod / 12; // Convert months to years
            const fuelConsumedPerYear = distance / mileage;
            const totalFuelCost = fuelConsumedPerYear * fuelCost * ownershipPeriodInYears;
            const totalServiceMaintenance = serviceMaintenance * ownershipPeriodInYears;

            // Total Expenses Calculation
			const carCost = downPayment + totalLoanAmount;
            const totalMaintenanceCost = totalFuelCost + totalServiceMaintenance + otherMaintenance;
            const totalExpense = downPayment + totalLoanAmount + totalMaintenanceCost;

            // Calculate expenses for months paid
            const carCostToDate = downPayment + emiPaidToDate;
			const totalFuelCostPaid = fuelConsumedPerYear * fuelCost * (monthsPaid / 12);
            const totalServiceMaintenancePaid = serviceMaintenance * (monthsPaid / 12);
            const totalMaintenanceCostPaid = totalFuelCostPaid + totalServiceMaintenancePaid + otherMaintenance;
            const totalExpensePaid = downPayment + emiPaidToDate + totalMaintenanceCostPaid;

            // Generate and display the report
            const reportHTML = `
                <div class="report-section">
                    <h3>Car Details</h3>
                    <p><strong>Car Model:</strong> ${carModel}</p>
					<hr>
                </div>

                <div class="report-section">
                    <h3>Loan Details</h3>
                    <p><strong>Down Payment:</strong> ${downPayment.toFixed(2)}</p>
                    <p><strong>EMI (Monthly):</strong> ${emi.toFixed(2)}</p>
                    <p><strong>Total Loan Amount:</strong> ${totalLoanAmount.toFixed(2)}</p>
                    <p><strong>EMI Paid To-Date:</strong> ${emiPaidToDate.toFixed(2)}</p>
					<p><strong>EMI Due:</strong> ${emiToBePaid.toFixed(2)}</p>
					<p><strong>EMI Paid In Advance:</strong> ${emiPaidInAdvance.toFixed(2)}</p>
					<hr>
                </div>

                <div class="report-section">
                    <h3>Maintenance Cost for ${monthsPaid} Months To-Date</h3>
                    <p><strong>Car Cost:</strong> ${carCostToDate.toFixed(2)}</p>
					<p><strong>Fuel Cost:</strong> ${totalFuelCostPaid.toFixed(2)}</p>
                    <p><strong>Service Maintenance:</strong> ${totalServiceMaintenancePaid.toFixed(2)}</p>
                    <p><strong>Other Maintenance & Repair:</strong> ${otherMaintenance.toFixed(2)}</p>
                    <p><strong>Total Expense To-Date:</strong> ${totalExpensePaid.toFixed(2)}</p>
					<hr>
                </div>

                <div class="report-section">
                    <h3>Maintenance Cost for ${ownershipPeriodInYears} Years</h3>
					<p><strong>Car Cost:</strong> ${carCost.toFixed(2)}</p>
                    <p><strong>Fuel Cost:</strong> ${totalFuelCost.toFixed(2)}</p>
                    <p><strong>Service Maintenance:</strong> ${totalServiceMaintenance.toFixed(2)}</p>
                    <p><strong>Other Maintenance & Repair:</strong> ${otherMaintenance.toFixed(2)}</p>
                    <p><strong>Total Expense for Ownership Period:</strong> ${totalExpense.toFixed(2)}</p>
					<hr>
                </div>

				<div class="report-section">
                    <h3>Car Resale Value</h3>
					<p><strong>Current Resale Value:</strong> ${resaleValue.toFixed(2)}</p>
                </div>
            `;
            document.getElementById("expenseReport").innerHTML = reportHTML;
            document.getElementById("expenseReport").style.display = 'block';

			// Add Chart.js DataLabels plugin
			Chart.register(ChartDataLabels);

			// Determine the maximum value across all datasets and round it to the next greater million
			const maxYValue = Math.max(
				...[carCostToDate, totalFuelCostPaid, totalServiceMaintenancePaid, otherMaintenance,
				   carCost, totalFuelCost, totalServiceMaintenance, otherMaintenance]
			);
			const maxYValueRounded = Math.ceil(maxYValue / 1000000) * 1000000;

			// Generate the Bar Chart for Maintenance Cost To-Date
			const chartDataToDate = {
				labels: ['Car Cost', 'Fuel Cost Paid', 'Service Maintenance Paid', 'Other Maintenance'],
				datasets: [{
					label: 'Expense To-Date',
					data: [carCostToDate, totalFuelCostPaid, totalServiceMaintenancePaid, otherMaintenance],
					backgroundColor: '#2985A5',
					borderColor: '#ccccc',
					borderWidth: 1
				}]
			};
			const ctxToDate = document.getElementById('expenseChartToDate').getContext('2d');
			new Chart(ctxToDate, {
				type: 'bar',
				data: chartDataToDate,
				options: {
					responsive: true,
					maintainAspectRatio: false,
					plugins: {
						datalabels: {
							anchor: 'end',
							align: 'end',
							color: '#2985A5', // Text color
							font: {
								size: 12,
								weight: 'bold'
							},
							formatter: function(value) {
								return value.toLocaleString(); // Format value with commas
							}
						}
					},
					scales: {
						y: {
							beginAtZero: true,
							min: 0,
							max: maxYValueRounded,
							ticks: {
								callback: function(value) {
									return '' + value.toLocaleString();
								}
							}
						}
					}
				}
			});

			// Generate the Bar Chart for Maintenance Cost Ownership Period
			const chartDataOwnership = {
				labels: ['Car Cost', 'Fuel Cost Total', 'Service Maintenance Total', 'Other Maintenance'],
				datasets: [{
					label: 'Expense Ownership Period',
					data: [carCost, totalFuelCost, totalServiceMaintenance, otherMaintenance],
					backgroundColor: '#2985A5',
					borderColor: '#ccccc',
					borderWidth: 1
				}]
			};
			const ctxOwnership = document.getElementById('expenseChartOwnership').getContext('2d');
			new Chart(ctxOwnership, {
				type: 'bar',
				data: chartDataOwnership,
				options: {
					responsive: true,
					maintainAspectRatio: false,
					plugins: {
						datalabels: {
							anchor: 'end',
							align: 'end',
							color: '#2985A5', // Text color
							font: {
								size: 12,
								weight: 'bold'
							},
							formatter: function(value) {
								return value.toLocaleString(); // Format value with commas
							}
						}
					},
					scales: {
						y: {
							beginAtZero: true,
							min: 0,
							max: maxYValueRounded,
							ticks: {
								callback: function(value) {
									return '' + value.toLocaleString();
								}
							}
						}
					}
				}
			});
        }
		
		function loadLastSavedData() {
            // Load saved data from localStorage
            if (localStorage.getItem('carModel')) {
                document.getElementById('carModel').value = localStorage.getItem('carModel');
                document.getElementById('downPayment').value = localStorage.getItem('downPayment');
                document.getElementById('principal').value = localStorage.getItem('principal');
                document.getElementById('interestRate').value = localStorage.getItem('interestRate');
                document.getElementById('termMonths').value = localStorage.getItem('termMonths');
                document.getElementById('ownershipPeriod').value = localStorage.getItem('ownershipPeriod');
                document.getElementById('distance').value = localStorage.getItem('distance');
                document.getElementById('mileage').value = localStorage.getItem('mileage');
                document.getElementById('fuelCost').value = localStorage.getItem('fuelCost');
                document.getElementById('serviceMaintenance').value = localStorage.getItem('serviceMaintenance');
                document.getElementById('otherMaintenance').value = localStorage.getItem('otherMaintenance');
                document.getElementById('monthsPaid').value = localStorage.getItem('monthsPaid');
		document.getElementById('resaleValue').value = localStorage.getItem('resaleValue');
            } else {
                alert('No saved data found!');
            }
        }

        function loadNotes() {
            const notes = JSON.parse(localStorage.getItem('notes')) || [];
            const notesList = document.getElementById('notesList');
            notesList.innerHTML = '';
            notes.forEach((note, index) => {
                const noteElement = document.createElement('div');
                noteElement.classList.add('note');
                noteElement.innerHTML = `
                    <p>${note}</p>
                    <button onclick="deleteNote(${index})">Delete</button>
                `;
                notesList.appendChild(noteElement);
            });
        }

        function addNote() {
            const noteInput = document.getElementById('noteInput');
            const note = noteInput.value.trim();
            if (!note) {
                alert('Please enter a note.');
                return;
            }
            const notes = JSON.parse(localStorage.getItem('notes')) || [];
            notes.push(note);
            localStorage.setItem('notes', JSON.stringify(notes));
            noteInput.value = '';
            loadNotes();
        }

        function deleteNote(index) {
            const notes = JSON.parse(localStorage.getItem('notes')) || [];
            notes.splice(index, 1);
            localStorage.setItem('notes', JSON.stringify(notes));
            loadNotes();
        }

        loadNotes();
    </script>
</body>
</html>
